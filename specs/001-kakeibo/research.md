## リサーチ: 家計簿 — 月次収支記録とカテゴリ管理

### 決定事項

- 永続化: サーバサイド（PostgreSQL）を採用。オフライン同期は初期フェーズでは実装しない。
  - 理由: 匿名利用を前提とした場合でも、サーバ保存により整合性が取りやすく、複数端末からの閲覧が容易になるため。
- 通貨: 単一通貨（JPY）、小数点は 0 桁。
  - 理由: 日本向けの家計簿仕様であり、UI とデータ保存を簡素化するため。
- カテゴリ削除方針: 取引が存在するカテゴリは削除不可とする。
  - 理由: 過去データの整合性を保ち、孤立したレコードを防ぐため。
- ID 方針: 全エンティティに UUID を採用。
  - 理由: グローバルな一意性が確保され、クライアントとサーバ間の参照が容易になるため。
- 月境界/タイムゾーン: ユーザーのローカル日付を基準に集計（デフォルト: Asia/Tokyo）。
  - 理由: 月次表示はユーザーのカレンダー感覚に合わせるべきため。
- 監査と削除: ソフトデリート + 監査ログを採用。
  - 理由: 復元や調査、サポート対応を容易にするため。

### 検討した代替案

- ハイブリッド（オフライン優先）: コンフリクト処理や同期の複雑さが増し、本フェーズの範囲外。
- マルチ通貨対応: 為替処理と換算の複雑性が増すため、将来フェーズへ保留。

### 保留中の項目

- パフォーマンス目標の詳細（1,000 件/月以上の想定時の最適化など）
- バックアップ・保持ポリシーの具体値（保持期間など）

### 結論

初期フェーズはサーババックエンド（FastAPI + PostgreSQL）と Next.js フロントエンドで進める。契約（OpenAPI）を先に定義する（Contract-First）。
